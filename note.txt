
message body:  {'Type': 'Notification', 'MessageId': '44681df3-e2e8-5edc-bc95-43ad844b2f66', 'SequenceNumber': '10000000000000003000', 'TopicArn': 'arn:aws:sns:us-east-1:659248683008:nichada_subscription_upgrade.fifo', 'Message': "{'user_id': '9f3efc82-7d58-4812-8403-d7bbee60b81e'}", 'Timestamp': '2024-03-03T11:52:03.108Z', 'UnsubscribeURL': 'https://sns.us-east-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-east-1:659248683008:nichada_subscription_upgrade.fifo:3a13d465-7576-49ce-a999-ff1d4b332325'}

get result_files : [{'s3_results_bucket': 'mpcs-cc-gas-results', 'user_email': 'nichada@uchicago.edu', 'results_file_archive_id': 'AAUQgDtOCnhsHbBdERBywS3x7tatbOulbR6fkl8JR9F_KHHwwdZeb8cdH0cB53v3Kbv4HATp5YWFrCYcB9-pp2C-2GWl4HqT9hTTFD2dzM94D8uSMSfuF7bTkZ9hc5qn8ChvyMKRQQ', 'job_id': 'ec6147df-c3f3-4dd0-97c5-8d0e3186add1', 'submit_time': Decimal('1709464400'), 'user_id': '9f3efc82-7d58-4812-8403-d7bbee60b81e', 'input_file_name': 'ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf', 's3_key_log_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf.count.log', 's3_key_result_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.annot.vcf', 'complete_time': Decimal('1709464411'), 's3_key_input_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf', 's3_inputs_bucket': 'mpcs-cc-gas-inputs', 'job_status': 'COMPLETED'}]
InsufficientCapacityException
Expedited retrieval failed, falling back to standard retrieval.
Published message to SNS topic: {'MessageId': '097c36e3-6778-54e7-aea5-68bd1638a447', 'SequenceNumber': '10000000000000040000', 'ResponseMetadata': {'RequestId': 'ea024f57-2cea-54a9-8036-11095daaa409', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amzn-requestid': 'ea024f57-2cea-54a9-8036-11095daaa409', 'date': 'Sun, 03 Mar 2024 12:37:20 GMT', 'content-type': 'text/xml', 'content-length': '352', 'connection': 'keep-alive'}, 'RetryAttempts': 0}}
Failed to delete message from the queue: {e}
message body:  {'Type': 'Notification', 'MessageId': '44681df3-e2e8-5edc-bc95-43ad844b2f66', 'SequenceNumber': '10000000000000003000', 'TopicArn': 'arn:aws:sns:us-east-1:659248683008:nichada_subscription_upgrade.fifo', 'Message': "{'user_id': '9f3efc82-7d58-4812-8403-d7bbee60b81e'}", 'Timestamp': '2024-03-03T11:52:03.108Z', 'UnsubscribeURL': 'https://sns.us-east-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-east-1:659248683008:nichada_subscription_upgrade.fifo:3a13d465-7576-49ce-a999-ff1d4b332325'}

get result_files : [{'s3_results_bucket': 'mpcs-cc-gas-results', 'user_email': 'nichada@uchicago.edu', 'results_file_archive_id': 'AAUQgDtOCnhsHbBdERBywS3x7tatbOulbR6fkl8JR9F_KHHwwdZeb8cdH0cB53v3Kbv4HATp5YWFrCYcB9-pp2C-2GWl4HqT9hTTFD2dzM94D8uSMSfuF7bTkZ9hc5qn8ChvyMKRQQ', 'job_id': 'ec6147df-c3f3-4dd0-97c5-8d0e3186add1', 'submit_time': Decimal('1709464400'), 'user_id': '9f3efc82-7d58-4812-8403-d7bbee60b81e', 'input_file_name': 'ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf', 's3_key_log_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf.count.log', 's3_key_result_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.annot.vcf', 'complete_time': Decimal('1709464411'), 's3_key_input_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf', 's3_inputs_bucket': 'mpcs-cc-gas-inputs', 'job_status': 'COMPLETED'}]
InsufficientCapacityException
Expedited retrieval failed, falling back to standard retrieval.
Published message to SNS topic: {'MessageId': 'b5515874-954d-559a-9433-062ae416851e', 'SequenceNumber': '10000000000000041000', 'ResponseMetadata': {'RequestId': '83875208-46e6-50aa-8030-0c5637bdb02e', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amzn-requestid': '83875208-46e6-50aa-8030-0c5637bdb02e', 'date': 'Sun, 03 Mar 2024 12:37:47 GMT', 'content-type': 'text/xml', 'content-length': '352', 'connection': 'keep-alive'}, 'RetryAttempts': 0}}
Failed to delete message from the queue: {e}


Update Item succeeded: {'Attributes': {'s3_results_bucket': 'mpcs-cc-gas-results', 'results_file_archive_id': 'u65TYpDtQcwD90hlcOveKNJA0qc7tqAOhyXYk7LoXBb2h4A7HlTGdDeS8IMGqwLJ0THuQ69JtzOIsgE5_OpoYo6o2ABzHk5MPOdgSfIf4mYrIxmnGLApG0vt97pn1mNfO_4mzF-rXg', 'user_email': 'nichada@uchicago.edu', 'job_id': '95a67f2d-5fc8-4028-8bec-7770e7a68826', 'restore_message': 'Your file is being restored from archive and will be available shortly.', 'submit_time': Decimal('1709470002'), 'input_file_name': '95a67f2d-5fc8-4028-8bec-7770e7a68826~test.vcf', 's3_key_log_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/95a67f2d-5fc8-4028-8bec-7770e7a68826/95a67f2d-5fc8-4028-8bec-7770e7a68826~test.vcf.count.log', 's3_key_result_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/95a67f2d-5fc8-4028-8bec-7770e7a68826/95a67f2d-5fc8-4028-8bec-7770e7a68826~test.annot.vcf', 'user_id': '9f3efc82-7d58-4812-8403-d7bbee60b81e', 'complete_time': Decimal('1709470013'), 's3_key_input_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/95a67f2d-5fc8-4028-8bec-7770e7a68826~test.vcf', 's3_inputs_bucket': 'mpcs-cc-gas-inputs', 'job_status': 'COMPLETED'}, 'ResponseMetadata': {'RequestId': 'C5HHVS18GDGA3JFTME0495CA9FVV4KQNSO5AEMVJF66Q9ASUAAJG', 'HTTPStatusCode': 200, 'HTTPHeaders': {'server': 'Server', 'date': 'Sun, 03 Mar 2024 13:59:04 GMT', 'content-type': 'application/x-amz-json-1.0', 'content-length': '1149', 'connection': 'keep-alive', 'x-amzn-requestid': 'C5HHVS18GDGA3JFTME0495CA9FVV4KQNSO5AEMVJF66Q9ASUAAJG', 'x-amz-crc32': '2347821518'}, 'RetryAttempts': 0}}
InsufficientCapacityException
Expedited retrieval failed, falling back to standard retrieval.
Published message to SNS topic: {'MessageId': 'df75b048-d93b-5b17-924b-ee165d4a7adc', 'SequenceNumber': '10000000000000072000', 'ResponseMetadata': {'RequestId': 'bee9c43d-68cb-5c5c-b9a2-9a63ecba7d97', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amzn-requestid': 'bee9c43d-68cb-5c5c-b9a2-9a63ecba7d97', 'date': 'Sun, 03 Mar 2024 13:59:13 GMT', 'content-type': 'text/xml', 'content-length': '352', 'connection': 'keep-alive'}, 'RetryAttempts': 0}}
Update Item succeeded: {'Attributes': {'s3_results_bucket': 'mpcs-cc-gas-results', 'results_file_archive_id': 'AAUQgDtOCnhsHbBdERBywS3x7tatbOulbR6fkl8JR9F_KHHwwdZeb8cdH0cB53v3Kbv4HATp5YWFrCYcB9-pp2C-2GWl4HqT9hTTFD2dzM94D8uSMSfuF7bTkZ9hc5qn8ChvyMKRQQ', 'user_email': 'nichada@uchicago.edu', 'job_id': 'ec6147df-c3f3-4dd0-97c5-8d0e3186add1', 'restore_message': 'Your file is being restored from archive and will be available shortly.', 'submit_time': Decimal('1709464400'), 'input_file_name': 'ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf', 's3_key_log_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf.count.log', 's3_key_result_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.annot.vcf', 'user_id': '9f3efc82-7d58-4812-8403-d7bbee60b81e', 'complete_time': Decimal('1709464411'), 's3_key_input_file': 'nichada/9f3efc82-7d58-4812-8403-d7bbee60b81e/ec6147df-c3f3-4dd0-97c5-8d0e3186add1~test.vcf', 's3_inputs_bucket': 'mpcs-cc-gas-inputs', 'job_status': 'COMPLETED'}, 'ResponseMetadata': {'RequestId': 'P5CGKBH2VK5UNCCFJ9P8G9BL3RVV4KQNSO5AEMVJF66Q9ASUAAJG', 'HTTPStatusCode': 200, 'HTTPHeaders': {'server': 'Server', 'date': 'Sun, 03 Mar 2024 13:59:13 GMT', 'content-type': 'application/x-amz-json-1.0', 'content-length': '1149', 'connection': 'keep-alive', 'x-amzn-requestid': 'P5CGKBH2VK5UNCCFJ9P8G9BL3RVV4KQNSO5AEMVJF66Q9ASUAAJG', 'x-amz-crc32': '1235874358'}, 'RetryAttempts': 0}}
Deleted message: 80fBts5Eubn0zO7ZLDkm925119ThhSGJnhKcLIsuErHKPZ2P7uIprgR_E3ErJE2EhWq7KqUxlJPvOQR0_iFstmJllv0S from the queue


-------- setting alarm -------------

aws cloudwatch put-metric-alarm --alarm-name nichada-web-alarm-response10ms \
    --namespace AWS/ApplicationELB \
    --dimensions Name=LoadBalancerName,Value=nichada-elb \
    --metric-name TargetResponseTime \
    --statistic Average \
    --period 60 \
    --evaluation-periods 1 \
    --datapoints-to-alarm 1 \
    --threshold 0.010 \
    --comparison-operator "LessThanThreshold" \
    --alarm-description "Alarm when target response time is below 10ms for at least one minute" \
    --actions-enabled \
    --unit "Seconds"

---------------------------------------
